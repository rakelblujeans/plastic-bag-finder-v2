<ion-header>
  <ion-navbar color="halloween">
    <ion-title>
      <img class="bag-logo" src="assets/images/bag.svg">
      Trick or Treat
    </ion-title>
  </ion-navbar>
</ion-header>

<ion-content>
  <!-- Real floating action button, fixed. It will not scroll with the content -->
  <ion-fab top right edge>
    <button ion-fab mini color="dark" (click)="openAddPanel()">
      <ion-icon name="add"></ion-icon>
    </button>
  </ion-fab>

  <ion-card>
    <ion-card-content class="pins-form" [ngClass]="{
          'is-visible': formExpanded,
          'is-hidden': !formExpanded
        }">
      <form #form="ngForm" novalidate>
      <ion-list no-lines>
        <ion-item>
          <ion-label floating>Enter new drop-off location</ion-label>
          <ion-input type="text" id="placeQuery" name="placeQuery" minlength="2" required
              [(ngModel)]="newPin.place" (keyup.enter)="$event.preventDefault()"
              (blur)="$event.preventDefault()">
          </ion-input>
        </ion-item>

        <ion-item>
          <button type="submit" ion-button color="secondary" class="pins-button"
              [disabled]="!form.form.valid" (click)="submitForm()">
            <ion-icon name="checkmark-circle"></ion-icon>
          </button>

          <button ion-button color="danger" class="pins-button" (click)="cancelForm($event)">
            <ion-icon name="close-circle"></ion-icon>
          </button>
        </ion-item>
      </ion-list>
    </form>
    </ion-card-content>
  </ion-card>

  <ion-list>
    <ion-item-group>
      <ion-item-divider light>Approved Locations</ion-item-divider>

      <ion-item detail-push *ngFor="let pin of approvedPins | async">
        <h2>{{pin.name}}</h2>
        <p class="pins-address">
          {{pin.address}}<br>
          <small>Last updated {{formatDate(pin.updatedAt)}}</small>
        </p>

        <!-- details -->
        <!--button ion-button outline item-right icon-right>
          <ion-icon name="arrow-forward"></ion-icon>
        </button-->
        <!-- delete -->
        <button ion-button outline (click)="remove(pin)">
          <ion-icon name="trash"></ion-icon>
        </button>
        <!-- flag -->
        <button ion-button outline (click)="flag(pin)" *ngIf="!pin.flagged">
          <ion-icon name="ios-flag-outline"></ion-icon>
        </button>
        <!-- unflag -->
        <button ion-button outline color="danger" (click)="unflag(pin)" *ngIf="pin.flagged">
          <ion-icon name="flag"></ion-icon>
        </button>
        <!-- unapprove -->
        <button ion-button outline (click)="unapprove(pin)" *ngIf="isApproved(pin)">
          <ion-icon name="checkmark-circle-outline"></ion-icon>
        </button>
        <!-- favorite -->
        <button ion-button outline color="favorite" (click)="favorite(pin)" *ngIf="!isFavorite(pin)">
          <ion-icon name="star"></ion-icon>
        </button>
        <!-- unfavorite -->
        <button ion-button outline (click)="unfavorite(pin)" *ngIf="isFavorite(pin)">
          <ion-icon name="star-outline"></ion-icon>
        </button>

         <a (click)="viewDetail(pin.$key, true)" item-right>View</a>
      </ion-item>

    </ion-item-group>
    <ion-item-group>
       <ion-item-divider light>Locations Awaiting Moderation</ion-item-divider>
      <ion-item *ngFor="let pin of submittedPins | async">
        <h2>{{pin.name}}</h2>
        <p class="pins-address">
          {{pin.address}}<br>
          <small>Last updated {{formatDate(pin.updatedAt)}}</small>
        </p>

        <!-- details -->
        <!--button ion-button outline item-right icon-right>
          <ion-icon name="arrow-forward"></ion-icon>
        </button-->
        <!-- delete -->
        <button ion-button outline (click)="remove(pin)">
          <ion-icon name="trash"></ion-icon>
        </button>
        <!-- flag -->
        <button ion-button outline (click)="flag(pin)" *ngIf="!pin.flagged">
          <ion-icon name="ios-flag-outline"></ion-icon>
        </button>
        <!-- unflag -->
        <button ion-button outline color="danger" (click)="unflag(pin)" *ngIf="pin.flagged">
          <ion-icon name="flag"></ion-icon>
        </button>
        <!-- approve -->
        <button ion-button outline (click)="approve(pin)" *ngIf="!isApproved(pin)">
          <ion-icon name="checkmark-circle"></ion-icon>
        </button>
        <!-- favorite -->
        <button ion-button outline color="favorite" (click)="favorite(pin)" *ngIf="!isFavorite(pin)">
          <ion-icon name="star"></ion-icon>
        </button>
        <!-- unfavorite -->
        <button ion-button outline (click)="unfavorite(pin)"
            *ngIf="isFavorite(pin)">
          <ion-icon name="star-outline"></ion-icon>
        </button>

        <a (click)="viewDetail(pin.$key, false)" item-right>View</a>
      </ion-item>
    </ion-item-group>
  </ion-list>

</ion-content>
